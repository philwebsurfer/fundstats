---
title: "Exposition"
output:
  html_document:
    df_print: paged
---

_175904 -  Jorge III Altamirano Astorga_

# {.tabset}

Hepatatis-B (HB) is endemic in Africa. Considering a program in Gambia where we want to test the effectiveness of vaccination. We'd like to know the effectiveness afforded by the vaccination of 106 children, followed up. Each child, or observation is denoted by $i$.

The level of inmunity is measured in _anti-HB titre_. Titre being "the concentration of an antibody, as determined by finding the highest dilution at which it is still able to cause agglutination of the antigen".

We know, based on a previous study in Senegal (1991) that _anti-HB titre is proportional to the reciprocal of time since vaccination_, and so we work on the basis that the relationship between log-anti-HB-titre and log-time-since-vaccination should be approximately linear.

Let $y_{0i}$ and $y_{ij}$ denote the logbaseline and jth follow-up log-titre measurement: 1, 2 and 3.


Let $t_{ij}$ denote the log-time to which $y_{ij}$ corresponds.


```{r include=FALSE}
library(dplyr)
library(ggplot2)
library(R2jags)
library(R2OpenBUGS)
```

## Model

A non hierarchical model might be:

$$
y_{ij} \sim N(\phi_{ij}, \sigma^2), \\
\phi_{ij} = \alpha +  \beta(t_{ij} - \overline{t}) + \gamma(y_{0i} - \overline{y_0})
$$

Where $\overline{t}$ and $\overline{y_{0}}$ are the empirical means of the $t_{ij}$s and $y_0$s, respectively.

This model might sound a bit unrealistic, as it assumes the same intercept and slope for all individuals.

In a **hierarchical model**, we assume different intercepts and slopes. This model uses captures that all the individuals are related or similar. Using the very same Normal model (non hierarchical) but in a hierarchical fashion would be:

$$
y_{ij} \sim N(\phi_{ij}, \sigma^2), \\
\phi_{ij} = \alpha_i + \beta_i (t_{ij} - \overline{t}) + \gamma(y_{0i} - \overline{y_0}),\\
\alpha_i \sim N(\mu_\alpha, \omega^2_\alpha),\\
\beta_i  \sim N(\mu_\beta, \omega^2_\beta)
$$

All $\mu_\alpha$, $\omega_\alpha$, $\mu_\beta$, and $\omega_\beta$ have been assigned appropriate priors for this mentioned hierarchical model:

$$
\mu_\alpha \sim N(0, 0.0001), \\
\omega_\alpha \sim U(0, 100), \\
\mu_\beta \sim N(0, 0.0001), \\
\omega_\beta \sim U(0, 100), \\
log~ \sigma \sim U(-10, 10), \\
\gamma \sim N(0, 0.0001) 
$$

Data has `NA`s, and those are imputated from their predictive distributions, using the so called _pad out_ strategy. This has the benefit of having no impact on the inferences themselves. The trade off is the computation, and, fortunately in this case, the data is balanced. As all observations are 3 observations per child. We explicitly avoid the _bivariate_ exchangeability assumption, in this model. This model has _univariate_ exchangeability.

### BUGS Model

```{bash echo=FALSE}
cat exposition.txt
```



## Data

```{r data, include=FALSE}
y = structure(.Data = c(
  4.997, 8.028, NA,
  6.830,  4.905, 6.295,
  3.95124371858143, 4.35670882668959, 
	NA, 6.79794041297493, 5.27299955856375, 4.31748811353631, 
	4.71849887129509, 3.49650756146648, 4.29045944114839, 5.78996017089725, 
	3.68887945411394, 3.43398720448515, 6.13122648948314, 3.85014760171006, 
	NA, 6.76272950693188, 3.29583686600433, NA, 6.14846829591765, 
	5.25749537202778, 5.37527840768417, 10.7579879834538, 10.4925789214972, 
	NA, 5.63121178182137, 4.20469261939097, 3.49650756146648, 
	3.46573590279973, 1.79175946922805, 2.77258872223978, 7.92479591395644, 
	7.54750168281497, 6.40687998606931, 9.16115012778541, 8.34236350038058, 
	7.9483852851119, 8.74257423767064, 7.07580886397839, 6.3919171133926, 
	5.91079664404053, 5.11198778835654, 5.37989735354046, 6.54678541076052, 
	4.93447393313069, 5.86929691313377, 2.94443897916644, 3.17805383034795, 
	NA, 7.05272104923232, 6.25382881157547, 5.34233425196481, 0, 
	7.19067603433221, NA, 9.13905916997122, 7.82724090175281, NA, 
	8.48260174664662, 7.51697722460432, 4.45434729625351, 7.11963563801764, 
	5.8348107370626, 6.5424719605068, 7.64300363556072, 6.35610766069589, 
	6.89365635460264, 9.42294862137501, 8.57073395834427, 8.79026911147866, 
	8.2553088117856, 7.16394668434255, 7.46278915741245, 4.82028156560504, 
	3.40119738166216, 3.66356164612965, 6.54678541076052, 5.95583736946483, 
	4.99721227376411, 8.67470962929122, 7.32383056620232, 8.03040956213048, 
	7.86326672400957, 7.63385355968177, 7.16006920759613, 4.67282883446191, 
	3.36729582998647, 3.17805383034795, 7.41878088275079, 6.76157276880406, 
	NA, 6.84587987526405, 8.38845031552351, 6.31535800152233, 
	5.46383180502561, 9.9219166880045, NA, 3.43398720448515, 
	1.6094379124341, 2.77258872223978, 7.7553388128465, 7.44366368311559, 
	7.82803803212583, 9.04239498112674, 6.64768837356333, 7.11151211649616, 
	8.45212119467252, 6.85118492749374, 7.01481435127554, 7.91425227874244, 
	6.16961073249146, 6.00881318544259, 7.72885582385254, 9.75214127004149, 
	9.59703032475801, 9.31433996199467, 8.26359043261732, NA, 
	6.35957386867238, 5.84643877505772, NA, 2.30258509299405, 0, 
	2.30258509299405, 8.29354951506035, 7.60589000105312, 10.1017644761202, 
	8.90082160491523, 6.25958146406492, 7.06561336359772, 8.87905466204227, 
	8.88391747120797, NA, 11.5129154649202, 8.54286093816481, 
	8.97575663051942, 8.79618763547045, 7.86095636487639, 7.08757370555797, 
	8.40155784781731, 6.91075078796194, 7.22256601882217, 8.89370997756851, 
	7.59588991771854, NA, 7.1800698743028, 7.03174125876313, 
	2.07944154167984, 4.82028156560504, 2.99573227355399, 2.70805020110221, 
	5.77765232322266, 3.91202300542815, 3.61091791264422, 6.4707995037826, 
	5.4510384535657, NA, 4.40671924726425, 5.12989871492307, 
	3.85014760171006, 8.17413934342947, 7.88419993367604, 7.22766249872866, 
	2.30258509299405, 2.30258509299405, 0, 9.77104128523582, 
	9.32892308780313, 9.61767040669386, 6.95081476844258, 10.5472081164337, 
	8.66905554072548, 5.97635090929793, 5.71042701737487, 5.24174701505964, 
	5.8805329864007, 6.50128967054039, 5.48479693349065, 5.73979291217923, 
	5.53338948872752, 4.04305126783455, 5.75574221358691, 4.99043258677874, 
	NA, 5.15329159449778, 3.61091791264422, NA, 8.11761074646623, 
	7.34729970074316, 6.55250788703459, 8.54636356871602, 8.03138533062553, 
	7.35115822643069, 7.58171964012531, 6.92264389147589, 6.52502965784346, 
	6.9037472575846, 6.7202201551353, 5.74939298590825, 4.66343909411207, 
	3.43398720448515, 3.09104245335832, 7.47986413116503, 6.19236248947487, 
	NA, 3.61091791264422, 3.78418963391826, NA, 4.64439089914137, 
	4.51085950651685, 2.99573227355399, 4.39444915467244, 3.55534806148941, 
	3.29583686600433, 8.23509549725836, 7.81116338502528, 7.54855597916987, 
	6.12905021006055, 6.19847871649231, 4.81218435537242, 8.4424696452203, 
	3.55534806148941, 2.94443897916644, 6.88755257166462, 5.07517381523383, 
	NA, 7.29233717617388, 7.25417784645652, NA, 6.38856140554563, 
	6.21460809842219, 5.03043792139244, 8.75998249497728, 7.19593722647557, 
	NA, 6.08677472691231, 4.66343909411207, 2.39789527279837, 
	4.02535169073515, 3.78418963391826, 2.94443897916644, 4.38202663467388, 
	2.484906649788, NA, 6.85540879860993, 6.08221891037645, 
	5.45958551414416, 8.17919979842309, 6.04500531403601, NA, 
	4.24849524204936, 3.52636052461616, 3.58351893845611, 8.98343977178426, 
	9.69990150043745, 8.74097653801779, 8.4721958254855, 7.76004068088038, 
	NA, 9.480214825778, 7.78113850984502, NA, 6.1463292576689, 
	6.289715570909, 5.87493073085203, 9.93542217106647, 9.39806397805913, 
	9.17294998275762, 4.27666611901606, 5.34710753071747, 3.46573590279973, 
	5.36597601502185, 5.88887795833288, 3.36729582998647, 4.60517018598809, 
	5.29831736654804, 3.58351893845611, 3.2188758248682, 4.27666611901606, 
	7.63867982387611, 6.81783057145415, 3.46573590279973, NA, 
	6.58479139238572, 7.2152399787301, 5.90808293816893, 5.91889385427315, 
	5.68357976733868, 5.8171111599632, 8.67641669696422, 7.72179177681754, 
	6.19031540585315, 2.484906649788, 1.38629436111989, 2.56494935746154, 
	6.73933662735717, 6.73221070646721, 4.51085950651685, 3.91202300542815, 
	5.4971682252932, 4.39444915467244, 4.56434819146784, 2.83321334405622, 
	NA, 9.15925758174687, 8.58073121222023, NA, 7.07326971745971, 
	7.12608727329912, 5.01063529409626, 9.08636319215647, 7.9359451033537, 
	NA), .Dim = c(106,3))
t = structure(.Data = c(
	6.541, 6.963, 10, 
	5.8406416573734, 6.52941883826223, 6.98193467715639, 6.60123011872888, 
	7.02553831463852, 10, 5.8636311755981, 6.51767127291227, 
	6.96790920180188, 5.91350300563827, 6.5694814204143, 7.00850518208228, 
	5.91889385427315, 6.5694814204143, 7.00760061395185, 5.87493073085203, 
	6.97447891102505, 10, 5.82008293035236, 6.56244409369372, 10, 
	5.91350300563827, 6.5510803350434, 7.00306545878646, 5.98896141688986, 
	7.0335064842877, 10, 5.95064255258773, 6.59987049921284, 
	7.00940893270864, 5.75574221358691, 6.65544035036765, 6.9555926083963, 
	5.92157841964382, 6.70686233660275, 6.98286275146894, 5.93489419561959, 
	6.63987583382654, 6.9782137426307, 5.91350300563827, 6.63987583382654, 
	6.9782137426307, 5.97126183979046, 6.55961523749324, 7.00124562206948, 
	5.97126183979046, 6.60123011872888, 7.00033446027523, 6.59987049921284, 
	7.00215595440362, 10, 5.92157841964382, 6.68959926917897, 
	6.96224346426621, 6.71780469502369, 6.98286275146894, 10, 
	5.92958914338989, 6.56807791141198, 10, 5.92157841964382, 
	6.71780469502369, 6.98286275146894, 5.92157841964382, 6.54821910276237, 
	6.98193467715639, 5.92157841964382, 6.54821910276237, 6.98193467715639, 
	5.92157841964382, 6.54821910276237, 6.98100574072173, 5.8406416573734, 
	6.54821910276237, 6.98100574072173, 5.89440283426485, 6.49072353450251, 
	6.95654544315157, 5.93489419561959, 6.70686233660275, 7.00306545878646, 
	5.93224518744801, 6.56103066589657, 7.0335064842877, 5.96870755998537, 
	6.52795791762255, 6.94215670569947, 5.8805329864007, 6.56244409369372, 
	6.97728134163075, 6.62671774924902, 6.94889722231331, 10, 
	5.87773578177964, 6.54965074223381, 6.98841318199959, 6.59030104819669, 
	7.00669522683704, 10, 5.92958914338989, 6.56807791141198, 
	6.98193467715639, 5.92958914338989, 6.56807791141198, 6.98193467715639, 
	5.86078622346587, 6.55819780281227, 6.97447891102505, 5.89440283426485, 
	6.59030104819669, 6.98378996525813, 5.95064255258773, 6.51767127291227, 
	6.97447891102505, 5.93224518744801, 6.70196036600254, 6.97447891102505, 
	5.97126183979046, 6.60934924316738, 10, 6.57088296233958, 
	7.01571242048723, 10, 5.93753620508243, 6.5206211275587, 
	6.97073007814353, 5.87493073085203, 6.56103066589657, 6.97447891102505, 
	5.89164421182577, 6.59030104819669, 6.98378996525813, 6.74170069465205, 
	6.98933526597456, 10, 5.89440283426485, 6.5410299991899, 
	6.98286275146894, 5.94803498918065, 6.5510803350434, 6.99668148817654, 
	5.77455154554441, 6.49828214947643, 6.95844839329766, 5.97126183979046, 
	6.54965074223381, 10, 5.96870755998537, 6.58892647753352, 
	7.01481435127554, 5.8805329864007, 6.59030104819669, 6.98378996525813, 
	5.89440283426485, 6.5410299991899, 6.98286275146894, 6.62936325343745, 
	6.98471632011826, 10, 5.93224518744801, 6.62007320653036, 
	7.03174125876313, 5.99146454710798, 6.63856778916652, 7.04053639021596, 
	5.88887795833288, 6.59441345974978, 7.02908756414966, 5.93489419561959, 
	6.61873898351722, 7.04577657687951, 5.94017125272043, 6.62140565176413, 
	7.05272104923232, 5.95583736946483, 6.62936325343745, 7.05272104923232, 
	5.93489419561959, 6.61873898351722, 7.04490511712937, 5.92692602597041, 
	6.61204103483309, 7.04141166379481, 6.64639051484773, 7.04403289727469, 
	10, 5.93224518744801, 6.62007320653036, 10, 5.96870755998537, 
	6.64639051484773, 7.03174125876313, 5.93224518744801, 6.64768837356333, 
	7.028201432058, 5.93224518744801, 6.62007320653036, 7.03174125876313, 
	5.93224518744801, 6.62671774924902, 7.02731451403978, 5.94542060860658, 
	6.62140565176413, 7.05272104923232, 5.86929691313377, 6.5875500148248, 
	10, 6.65801104587075, 7.05875815251866, 10, 5.89715386763674, 
	6.59714570188665, 7.03174125876313, 6.00881318544259, 6.62936325343745, 
	7.03966034986208, 5.97126183979046, 6.66568371778241, 7.03878354138854, 
	5.97126183979046, 6.66440902035041, 7.04403289727469, 5.97126183979046, 
	6.66440902035041, 7.04403289727469, 6.00881318544259, 7.05185562295589, 
	10, 6.64639051484773, 7.04403289727469, 10, 5.88610403145016, 
	6.59167373200866, 7.028201432058, 5.75257263882563, 6.96129604591017, 
	10, 5.68017260901707, 6.50876913697168, 6.97541392745595, 
	5.77144112313002, 6.56244409369372, 6.99759598298193, 5.96100533962327, 
	6.66695679242921, 10, 5.75257263882563, 6.49828214947643, 
	6.99025650049388, 5.81413053182507, 7.02108396428914, 10, 
	5.63478960316925, 6.46769872610435, 6.95081476844258, 5.77455154554441, 
	6.48768401848461, 6.92067150424868, 5.77765232322266, 6.52209279817015, 
	10, 5.63121178182137, 6.55535689181067, 10, 5.70711026474888, 
	6.45833828334479, 6.91473089271856, 5.89164421182577, 6.48920493132532, 
	6.92165818415113, 5.77455154554441, 6.48920493132532, 6.92165818415113, 
	6.0591231955818, 6.62671774924902, 7.01391547481053, 5.8171111599632, 
	6.49223983502047, 6.94119005506837, 5.65248918026865, 6.42162226780652, 
	6.86380339145295, 5.60947179518496, 6.44413125670044, 10, 
	5.83773044716594, 6.48616078894409, 6.92165818415113, 5.91350300563827, 
	6.52649485957079, 6.97447891102505, 5.77455154554441, 6.45047042214418, 
	6.92755790627832, 5.83773044716594, 6.48463523563525, 6.91869521902047, 
	5.98645200528444, 6.51025834052315, 6.96413561241824, 5.8171111599632, 
	6.48463523563525, 6.94793706861497, 6.49526555593701, 6.94215670569947, 
	10, 5.68697535633982, 6.47850964220857, 10, 5.8171111599632, 
	6.51174532964473, 6.93634273583405, 5.85793315448346, 6.92264389147589, 
	10), .Dim = c(106,3))
y0 = c(
	8.613, 7.105, 6.896, 
	5.63835466933375, 6.35088571671474, 5.03043792139244, 5.8664680569333, 
	5.73979291217923, 7.07834157955767, 8.56655462095396, 6.86171134048073, 
	6.97354301952014, 7.34213173058472, 8.82629423124132, 6.48768401848461, 
	6.66440902035041, 7.0343879299155, 4.49980967033027, 6.85118492749374, 
	3.04452243772342, 8.63905677917308, 1.79175946922805, 7.01660968389422, 
	7.09090982207998, 7.42356844425917, 8.09620827165004, 5.70711026474888, 
	7.01031186730723, 7.18311170174328, 8.15219801586179, 5.99645208861902, 
	7.0825485693553, 5.06890420222023, 7.04228617193974, 4.0943445622221, 
	7.32052696227274, 7.12689080889881, 7.24136628332232, 6.62007320653036, 
	7.36897040219479, 8.47720418319987, 7.20340552108309, 2.89037175789616, 
	7.39141523467536, 6.25190388316589, 8.38160253710989, 11.5129154649202, 
	6.60258789218934, 7.61283103040736, 7.42476176182321, 6.71174039505618, 
	5.56068163101553, 6.0282785202307, 7.10085190894405, 7.52671756135271, 
	7.92948652331429, 1.6094379124341, 6.85856503479136, 8.05006542291597, 
	5.83188247728352, 7.15851399732932, 7.01481435127554, 7.70120018085745, 
	7.16239749735572, 5.99893656194668, 5.41610040220442, 8.40782465436087, 
	7.18462915271731, 3.25809653802148, 8.14380797677148, 5.24702407216049, 
	5.73979291217923, 4.55387689160054, 7.72444664563354, 7.91425227874244, 
	7.11476944836646, 8.24064886337491, 8.56044423341055, 6.78558764500793, 
	10.8861838116069, 2.07944154167984, 5.82894561761021, 4.0943445622221, 
	7.53208814354172, 5.66988092298052, 3.46573590279973, 10.7229148990064, 
	8.02910705461974, 9.23092700558457, 6.42971947803914, 11.5129154649202, 
	7.25700270709207, 6.62007320653036, 9.41995278900604, 5.28826703069454, 
	8.04654935728308, 7.58984151218266, 6.39024066706535, 6.04025471127741, 
	2.77258872223978, 7.62948991639399, 7.85476918349913, 7.09007683577609, 
	5.50125821054473, 6.98100574072173, 5.50533153593236)
```

The three observations $j$ per child $i$, in log-titre:

```{r warning=FALSE, echo=FALSE}
ggplot(data=data.frame(y)) + 
  geom_histogram(aes(x=X1), bins=20, fill="blue", alpha=0.7) +
  geom_histogram(aes(x=X3), bins=20, fill="black", alpha=0.7) +
  geom_histogram(aes(x=X2), bins=20, fill="red", alpha=0.7) 
```

$t$ (log time) is shown here for, different colors represent the 3 observations per child:

```{r echo=FALSE}
ggplot(data=data.frame(t)) + 
  geom_histogram(aes(x=X1), bins=20, fill="blue", alpha=0.7) +
  geom_histogram(aes(x=X3), bins=20, fill="black", alpha=0.7) +
  geom_histogram(aes(x=X2), bins=20, fill="red", alpha=0.7)
```

And $y_0$:

```{r echo=FALSE}
ggplot(data=data.frame(y0)) + 
  geom_histogram(aes(x=y0), bins=20) 
```



## Hierarchical Model Simulations

```{r data2}
data2 <- list(
  N = 106.0,
  t = structure(.Data = c(
    6.541,6.963,10.0,5.841,6.529,
    6.982,6.601,7.026,10.0,5.864,
    6.518,6.968,5.914,6.569,7.009,
    5.919,6.569,7.008,5.875,6.974,
    10.0,5.82,6.562,10.0,5.914,
    6.551,7.003,5.989,7.034,10.0,
    5.951,6.6,7.009,5.756,6.655,
    6.956,5.922,6.707,6.983,5.935,
    6.64,6.978,5.914,6.64,6.978,
    5.971,6.56,7.001,5.971,6.601,
    7.0,6.6,7.002,10.0,5.922,
    6.69,6.962,6.718,6.983,10.0,
    5.93,6.568,10.0,5.922,6.718,
    6.983,5.922,6.548,6.982,5.922,
    6.548,6.982,5.922,6.548,6.981,
    5.841,6.548,6.981,5.894,6.491,
    6.957,5.935,6.707,7.003,5.932,
    6.561,7.034,5.969,6.528,6.942,
    5.881,6.562,6.977,6.627,6.949,
    10.0,5.878,6.55,6.988,6.59,
    7.007,10.0,5.93,6.568,6.982,
    5.93,6.568,6.982,5.861,6.558,
    6.974,5.894,6.59,6.984,5.951,
    6.518,6.974,5.932,6.702,6.974,
    5.971,6.609,10.0,6.571,7.016,
    10.0,5.938,6.521,6.971,5.875,
    6.561,6.974,5.892,6.59,6.984,
    6.742,6.989,10.0,5.894,6.541,
    6.983,5.948,6.551,6.997,5.775,
    6.498,6.958,5.971,6.55,10.0,
    5.969,6.589,7.015,5.881,6.59,
    6.984,5.894,6.541,6.983,6.629,
    6.985,10.0,5.932,6.62,7.032,
    5.991,6.639,7.041,5.889,6.594,
    7.029,5.935,6.619,7.046,5.94,
    6.621,7.053,5.956,6.629,7.053,
    5.935,6.619,7.045,5.927,6.612,
    7.041,6.646,7.044,10.0,5.932,
    6.62,10.0,5.969,6.646,7.032,
    5.932,6.648,7.028,5.932,6.62,
    7.032,5.932,6.627,7.027,5.945,
    6.621,7.053,5.869,6.588,10.0,
    6.658,7.059,10.0,5.897,6.597,
    7.032,6.009,6.629,7.04,5.971,
    6.666,7.039,5.971,6.664,7.044,
    5.971,6.664,7.044,6.009,7.052,
    10.0,6.646,7.044,10.0,5.886,
    6.592,7.028,5.753,6.961,10.0,
    5.68,6.509,6.975,5.771,6.562,
    6.998,5.961,6.667,10.0,5.753,
    6.498,6.99,5.814,7.021,10.0,
    5.635,6.468,6.951,5.775,6.488,
    6.921,5.778,6.522,10.0,5.631,
    6.555,10.0,5.707,6.458,6.915,
    5.892,6.489,6.922,5.775,6.489,
    6.922,6.059,6.627,7.014,5.817,
    6.492,6.941,5.652,6.422,6.864,
    5.609,6.444,10.0,5.838,6.486,
    6.922,5.914,6.526,6.974,5.775,
    6.45,6.928,5.838,6.485,6.919,
    5.986,6.51,6.964,5.817,6.485,
    6.948,6.495,6.942,10.0,5.687,
    6.479,10.0,5.817,6.512,6.936,
    5.858,6.923,10.0),
    .Dim = c(106,3)),
  tbar = 6.5,
  y = structure(.Data = c(
    4.997,8.028,            NA,6.83,4.905,
    6.295,3.951,4.357,            NA,6.798,
    5.273,4.317,4.718,3.497,4.29,
    5.79,3.689,3.434,6.131,3.85,
                NA,6.763,3.296,            NA,6.148,
    5.257,5.375,10.76,10.49,            NA,
    5.631,4.205,3.497,3.466,1.792,
    2.773,7.925,7.548,6.407,9.161,
    8.342,7.948,8.743,7.076,6.392,
    5.911,5.112,5.38,6.547,4.934,
    5.869,2.944,3.178,            NA,7.053,
    6.254,5.342,0.0,7.191,            NA,
    9.139,7.827,            NA,8.483,7.517,
    4.454,7.12,5.835,6.542,7.643,
    6.356,6.894,9.423,8.571,8.79,
    8.255,7.164,7.463,4.82,3.401,
    3.664,6.547,5.956,4.997,8.675,
    7.324,8.03,7.863,7.634,7.16,
    4.673,3.367,3.178,7.419,6.762,
                NA,6.846,8.388,6.315,5.464,
    9.922,            NA,3.434,1.609,2.773,
    7.755,7.444,7.828,9.042,6.648,
    7.112,8.452,6.851,7.015,7.914,
    6.17,6.009,7.729,9.752,9.597,
    9.314,8.264,            NA,6.36,5.846,
                NA,2.303,0.0,2.303,8.294,
    7.606,10.1,8.901,6.26,7.066,
    8.879,8.884,            NA,11.51,8.543,
    8.976,8.796,7.861,7.088,8.402,
    6.911,7.223,8.894,7.596,            NA,
    7.18,7.032,2.079,4.82,2.996,
    2.708,5.778,3.912,3.611,6.471,
    5.451,            NA,4.407,5.13,3.85,
    8.174,7.884,7.228,2.303,2.303,
    0.0,9.771,9.329,9.618,6.951,
    10.55,8.669,5.976,5.71,5.242,
    5.881,6.501,5.485,5.74,5.533,
    4.043,5.756,4.99,            NA,5.153,
    3.611,            NA,8.118,7.347,6.553,
    8.546,8.031,7.351,7.582,6.923,
    6.525,6.904,6.72,5.749,4.663,
    3.434,3.091,7.48,6.192,            NA,
    3.611,3.784,            NA,4.644,4.511,
    2.996,4.394,3.555,3.296,8.235,
    7.811,7.549,6.129,6.198,4.812,
    8.442,3.555,2.944,6.888,5.075,
                NA,7.292,7.254,            NA,6.389,
    6.215,5.03,8.76,7.196,            NA,
    6.087,4.663,2.398,4.025,3.784,
    2.944,4.382,2.485,            NA,6.855,
    6.082,5.46,8.179,6.045,            NA,
    4.248,3.526,3.584,8.983,9.7,
    8.741,8.472,7.76,            NA,9.48,
    7.781,            NA,6.146,6.29,5.875,
    9.935,9.398,9.173,4.277,5.347,
    3.466,5.366,5.889,3.367,4.605,
    5.298,3.584,3.219,4.277,7.639,
    6.818,3.466,            NA,6.585,7.215,
    5.908,5.919,5.684,5.817,8.676,
    7.722,6.19,2.485,1.386,2.565,
    6.739,6.732,4.511,3.912,5.497,
    4.394,4.564,2.833,            NA,9.159,
    8.581,            NA,7.073,7.126,5.011,
    9.086,7.936,            NA),
    .Dim = c(106,3)),
  y0 = c(
    8.613,7.105,6.896,5.638,6.351,
    5.03,5.866,5.74,7.078,8.567,
    6.862,6.974,7.342,8.826,6.488,
    6.664,7.034,4.5,6.851,3.045,
    8.639,1.792,7.017,7.091,7.424,
    8.096,5.707,7.01,7.183,8.152,
    5.996,7.083,5.069,7.042,4.094,
    7.321,7.127,7.241,6.62,7.369,
    8.477,7.203,2.89,7.391,6.252,
    8.382,11.51,6.603,7.613,7.425,
    6.712,5.561,6.028,7.101,7.527,
    7.929,1.609,6.859,8.05,5.832,
    7.159,7.015,7.701,7.162,5.999,
    5.416,8.408,7.185,3.258,8.144,
    5.247,5.74,4.554,7.724,7.914,
    7.115,8.241,8.56,6.786,10.89,
    2.079,5.829,4.094,7.532,5.67,
    3.466,10.72,8.029,9.231,6.43,
    11.51,7.257,6.62,9.42,5.288,
    8.047,7.59,6.39,6.04,2.773,
    7.629,7.855,7.09,5.501,6.981,
    5.505))
```


```{r}
#-Defining data-
data <-list("N" = 106, "tbar" = 6.5,
     "y" = y,
     "t" = t,
     "y0" = y0)

#-Defining inits-
inits <- function(){
  list(log.sigma = 0, omega.alpha = 0.1, omega.beta = 0.1,
     mu.alpha = 0, mu.beta = 0, gamma = 0)
}

#-Selecting parameters to monitor-
parameters<-c("gamma","mu.alpha", "mu.beta",
              "omega.alpha.squared",
              "omega.beta.squared",
              "sigma.squared")

#-Running code-
#OpenBUGS
sim<-bugs(data2,inits,parameters,model.file="exposition.txt",
              n.iter=10000,n.chains=2,n.burnin=1000)
sim
```

## Non-Hierarchical Model Simulations

```{r}
#-Defining inits-
inits <- function(){
  list(log.sigma = 0, alpha = 0, beta = 0, gamma = 0)
}

#-Selecting parameters to monitor-
parameters<-c("gamma", "alpha", "beta",
              "sigma.squared")

#-Running code-
#OpenBUGS
simb<-bugs(data2,inits,parameters,model.file="expositionb.txt",
              n.iter=10000,n.chains=2,n.burnin=1000)
simb
```

